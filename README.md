## Сервис проведения тендеров

### Стэк
- Go, Gin, pgxpool

### Логика сервиса
![img со схемой работы всех слоев](./docs/service-logic.jpg)


### Новые сущности
[migrations](https://git.codenrock.com/avito-testirovanie-na-backend-1270/cnrprod1725721384-team-77753/zadanie-6105/-/tree/dev/migrations?ref_type=heads)
- png со схемой таблиц

### Возникшие проблемы и их решения(ADR)

# README

## Возникшие проблемы и их решения (ADR)

| Номер | Группа   | Проблема                                 | Описание                                                                                      | Решение                                                                                                                |
|-------|---------|------------------------------------------|-----------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| 0     | database  | Добавление таблиц                        | Нужно создать новые таблицы в БД, доступ к которой ограничен.                                | При запуске сервиса создавать таблицы, если их нет.                                                                    |
| 1     | bid/tender | Версирование данных                      | Необходимо хранить версии для `bid` и `tender` с возможностью отката.                         | Хранить версии в отдельных таблицах для упрощения управления.                                                            |
| 2     | bid/tender | Оптимизация проверки прав пользователя   | Выбор между двумя запросами в БД: проверка существования работника и связь работника с организацией, или выполнение всех в одном запросе. | Сделать один сложный запрос, чтобы уменьшить количество запросов к БД. Написать MVP, если останется время, сравнить и оптимизировать. |
| 3     | tender  | Кто может получать статус тендера       | Необходимо определить, какие пользователи могут получать статус тендера.                     | Так как есть скрытые от пользователя статусы и в запросе передается имя пользователя, решено, что только ответственные за организацию могут получать статус тендера. |
| 4     | tender  | Обновление статуса тендера               | Повышать ли версию тендера при обновлении статуса?                                            | Статус обновляется часто и не влияет на основные данные. К тому же есть ручка на изменение статуса, поэтому версия не инкрементируется. |
| 5     | tender  | Связь таблиц tender и employee для проверки прав доступа | Возвращаемая структура тендера не содержит информации об авторе, но необходимо проверять права доступа. | Изначально была создана отдельная таблица, чтобы не изменять структуру `tender`, но это оказалось избыточным, так как у тендера один автор. В таблицу `tender` добавлено поле с `username`, которое игнорируется в структуре тендера. |
| 6     | bid     | Отправка нескольких предложений на тендер | Нужно решить, давать ли возможность пользователю отправлять несколько предложений на тендер. | Чтобы не нарушать бизнес-логику — одно предложение от одной организации для одного тендера — и избежать проблем с управлением и обработкой предложений, отказалась от этой идеи. |
| 7     | bid     | Получение предложений по тендеру        | Предложения с какими статусами выдавать создателю тендера: только `published` или все кроме `created`. | Выдавать все статусы, кроме `created`, так как это позволит увидеть историю работы с предложениями. |
